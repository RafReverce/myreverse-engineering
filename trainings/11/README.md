# 11 - Bypassing double checking on the debugger (CrackMe)

**–¶–µ–ª—å:** –û–±–æ–π—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –æ—Ç–ª–∞–¥—á–∏–∫ –∏ –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–æ–ª—å.


## üõ† –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- **Compiler:** MSVC (cl.exe)
- **Debugger:** x64dbg (x32 mode)
- **Decompiler:** Ghidra

## –ó–∞—â–∏—Ç–∞:
- **–î–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—Ç–ª–∞–¥—á–∏–∫ –≤ `000D10D4|FF15 00000F00|call dword ptr ds:[<IsDebuggerPresent>]` –∏ `000D1116|FF15 04000F00|call dword ptr ds:[<CheckRemoteDebuggerPresent>]`**

## üîç –ê–Ω–∞–ª–∏–∑ –∏ —Ä–µ—à–µ–Ω–∏–µ
1. **–ü–æ–∏—Å–∫:** –û—Ç–∫—Ä—ã–ª —Ñ–∞–π–ª –≤ –≤ –æ—Ç–ª–∞–¥—á–∏–∫–µ, —á–µ—Ä–µ–∑ –ø–æ–∏—Å–∫ `All modules -> string references` –Ω–∞—à–µ–ª `\n=== [SUCCESS] YOU BYPASSED ALL PROTECTIONS ===\n`.
2. **–õ–æ–≥–∏–∫–∞:** –ß—É—Ç—å –≤—ã—à–µ –æ–±–Ω–∞—Ä—É–∂–∏–ª –≤—ã–∑–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –æ—Ç–ª–∞–¥—á–∏–∫ `call dword ptr ds:[<IsDebuggerPresent>]`, –æ–Ω –∑–∞–ø–∏—Å—ã–≤–∞–ª –≤ —Ä–µ–≥–∏—Å—Ç—Ä `EAX`–∑–Ω–∞—á–µ–Ω–∏–µ 1, –µ—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—â–µ–Ω–∞ –≤ –¥–µ–±–∞–≥–≥–µ—Ä–µ –∏ 0, –µ—Å–ª–∏ –æ–±—ã—á–Ω–æ.
3. **–õ–æ–≥–∏–∫–∞:** –ü–æ—Å—Ç–∞–≤–∏–ª —Ç–æ—á–∫—É –æ—Å—Ç–∞–Ω–æ–≤–∞ –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–µ, –∑–∞–ø—É—Å—Ç–∏–ª –ø—Ä–æ–≥—Ä–∞–º–º—É –¥–æ —Ç–æ—á–∫–∏, –≤—Ä—É—á–Ω—É—é —Å–¥–µ–ª–∞–ª —à–∞–≥ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é –∏ —É–≤–∏–¥–µ–ª –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ `EAX` –∑–Ω–∞—á–µ–Ω–∏–µ 1, –∑–Ω–∞—á–∏—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–Ω–µ–µ –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ –º–µ–Ω—è –∏ –ø—ã—Ç–∞–ª–∞—Å—å –æ–± —ç—Ç–æ–º —Å–∫–∞–∑–∞—Ç—å, –∏ –¥–∞—Ç—å —Å–∏–≥–Ω–∞–ª –Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏–µ...
4. **–õ–æ–≥–∏–∫–∞:** –ü–æ–º–µ–Ω—è–ª –∑–Ω–∞—á–µ–Ω–∏–µ —Å 1 –Ω–∞ 0, —Ç–µ–º —Å–∞–º—ã–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–≤ –≤—ã–≥–æ–¥–Ω—ã–π –º–Ω–µ —Ö–æ–¥ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ß—É—Ç—å –Ω–∏–∂–µ –Ω–∞—à–µ–ª –∞–¥—Ä–µ—Å `call dword ptr ds:[<CheckRemoteDebuggerPresent>]`- —ç—Ç–æ –±—ã–ª –≤—Ç–æ—Ä–æ–π —ç—Ç–∞–ø –æ–±–æ—Ä–æ–Ω—ã. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–ª–∞ –≤ [ebx+14] –∑–Ω–∞—á–µ–Ω–∏–µ 0, –µ—Å–ª–∏ –æ—Ç–ª–∞–¥—á–∏–∫–∞ –Ω–µ—Ç –∏ 1, –µ—Å–ª–∏ –µ—Å—Ç—å. 
5. **–õ–æ–≥–∏–∫–∞:** –ü–æ—Å—Ç–∞–≤–∏–ª –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç –Ω–∞ —ç—Ç–æ –º–µ—Å—Ç–æ, –∑–∞–ø—É—Å—Ç–∏–ª –ø—Ä–æ–≥—Ä–∞–º–º—É –¥–æ —ç—Ç–æ–≥–æ –∞–¥—Ä–µ—Å–∞, –≤—Ä—É—á–Ω—É—é —Å–¥–µ–ª–∞–ª —à–∞–≥ –Ω–∞ –ø–æ—Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é `[ebp-04]:BaseThreadInitThunk`, –ø–æ—Å–ª–µ —è —É–≤–∏–¥–µ–ª –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞ 1. –û—Ç–∫—Ä—ã–ª –µ–≥–æ –≤ –¥–∞–º–ø–µ –∏ –ø–æ–º–µ–Ω—è–ª –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ 0, –ø–æ—Å–ª–µ —á–µ–≥–æ –ø—Ä–æ–¥–æ–ª–∂–∏–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.
6. **–õ–æ–≥–∏–∫–∞:** –ö–∞–∑–∞–ª–æ—Å—å –±—ã, –æ–±–µ –ª–∏–Ω–∏–∏ –æ–±–æ—Ä–æ–Ω—ã –ø—Ä–æ–π–¥–µ–Ω—ã –∏ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –ª–∏—à—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –¥–æ –ø–æ–±–µ–¥–Ω–æ–≥–æ `[SUCCESS]` , –Ω–æ –∫–∞–∫ –±—ã –Ω–µ —Ç–∞–∫. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø—Ä—ã–∂–∫–∞ `000D1121|74 26|je 11.D1149`–∫–∞–∫–∏–º-—Ç–æ –º–∞–≥–∏—á–µ—Å–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø–æ–¥ –∫–æ–Ω–µ—Ü –ø–æ–ª—É—á–∞–ª–∞ –∑–Ω–∞—á–µ–Ω–∏–µ 1 –∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–∞ –ø—Ä—ã–∂–æ–∫ –Ω–∞ "—É—Å–ø–µ—à–Ω–æ". –ú–Ω–µ –ø—Ä–∏—à–ª–æ—Å—å –ø—Ä–æ–ø–∞—Ç—á–∏—Ç—å –µ–µ –¥–æ –≤–∏–¥–∞ `jnz`.
7. **–í—ã–≤–æ–¥:**  –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏, –∑–∞–¥–∞—á–∞ –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, –ø—Ä—ã–∂–æ–∫ –ø–æ–ª—É—á–∞–ª –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –ø—Ä–µ–∏—Å–ø–æ–¥–Ω–∏–∏, –∏–±–æ –¥–æ —ç—Ç–æ–≥–æ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –Ω–µ –Ω—É–∂–Ω–æ–π –º–Ω–µ –µ–¥–∏–Ω–∏—Ü—ã –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ –±—ã–ª–∏ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã, –Ω–æ –ø—Ä—ã–∂–æ–∫ —Ç–∞–∫ –∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª—Å—è.
8. **–í—ã–≤–æ–¥:**  –ï—Å–ª–∏ –±—ã –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª–∑–ª–æ –æ—Ç–∫—É–¥–∞-—Ç–æ —Å–≤–µ—Ä—Ö—É - —Å—Ä–∞–±–æ—Ç–∞–ª–∞ –±—ã –∑–∞—â–∏—Ç–∞ –µ—â–µ –≤–Ω–∞—á–∞–ª–µ, –Ω–æ –Ω–µ—Ç, –æ–Ω–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ –ª–∏—à—å –ø–æ–¥ –∫–æ–Ω–µ—Ü. –ü–æ –∏—Ç–æ–≥—É  —è –¥–æ–±–∏–ª—Å—è –Ω—É–∂–Ω–æ–≥–æ **`[SUCCESS]`**.

## üìÑ –§–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ
- `11.cpp` ‚Äî –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥.
- `11.exe` ‚Äî –û—Ä–∏–≥–∏–Ω–∞–ª.

### –ì–∏–ø–æ—Ç–µ–∑–∞: 
- **–í–æ–∑–º–æ–∂–Ω–æ, —á—Ç–æ –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ Visual Studio —á—Ç–æ-—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–ª –≤ —Å–≤–æ–µ–º –ª—é–±–∏–º–æ–º –∫–ª—é—á–µ, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç–∞–ª–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –º–æ—è –¥–æ–≥–∞–¥–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞–º–∏ –∏–∑ Ghidra, –Ω–æ —ç—Ç–æ –Ω–µ —Ç–æ—á–Ω–æ**..